{
  "name": "Discovery Server - Eureka",
  "build": {
    "dockerfile": "Dockerfile",
    "context": "."
  },

  "customizations": {
    "vscode": {
      "extensions": [
        "vscjava.vscode-java-pack",
        "vmware.vscode-boot-dev-pack",
        "vscjava.vscode-gradle",
        "redhat.java"
      ],
      "settings": {
        "java.configuration.runtimes": [
          {
            "name": "GraalVM",
            "path": "/opt/graalvm-community-java2",
            "default": true
          }
        ],
        "java.jdt.ls.java.home": "/opt/graalvm-community-java2",
        "gradle.nestedProjects": true
      }
    }
  },

  "forwardPorts": [8761],
  "portsAttributes": {
    "8761": {
      "label": "Eureka Dashboard",
      "onAutoForward": "notify"
    }
  },

  "postCreateCommand": "chmod +x gradlew && ./gradlew clean build -x test",

  "postStartCommand": "echo 'Discovery Server Dev Container listo! üöÄ' && git config --list | grep user || echo '‚ö†Ô∏è  Configura tu Git local'",

  "remoteUser": "vscode",

  "features": {},

  "mounts": [
    "source=${localWorkspaceFolder},target=/workspace,type=bind,consistency=cached",
    "source=discovery-server-gradle-cache,target=/home/vscode/.gradle,type=volume",
    "source=${localEnv:HOME}${localEnv:USERPROFILE}/.gitconfig,target=/home/vscode/.gitconfig,type=bind,consistency=cached"
  ],

  "runArgs": [
    "--name=discovery-server-dev",
    "--network=conecta-seguros-network"
  ],

  "workspaceFolder": "/workspace",

  "containerEnv": {
    "JAVA_HOME": "/opt/graalvm-community-java2",
    "GRADLE_USER_HOME": "/home/vscode/.gradle",
    "SPRING_PROFILES_ACTIVE": "dev"
  },

  "remoteEnv": {
    "SSH_AUTH_SOCK": "${localEnv:SSH_AUTH_SOCK}"
  }
}